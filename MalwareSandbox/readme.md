Malware Analyzer
Descrição

O Malware Analyzer é uma ferramenta de análise estática de arquivos potencialmente maliciosos.
Ele lê o conteúdo do arquivo sem executá-lo e aplica diversas técnicas para identificar padrões suspeitos, calcular hashes, buscar URLs e IPs, medir entropia e, opcionalmente, consultar a API do VirusTotal.
O objetivo é auxiliar em pesquisas de segurança e pentesting em ambientes controlados.
Funcionalidades

    Análise de arquivos locais sem execução do código.

    Cálculo de hashes (MD5, SHA1, SHA256) para identificação.

    Detecção do tipo de arquivo (MIME type).

    Extração de strings ASCII e Unicode.

    Busca por URLs, IPs e domínios embutidos no arquivo.

    Cálculo de entropia (indica compressão ou criptografia).

    Análise de executáveis PE (Windows) para seções e bibliotecas importadas.

    Integração com VirusTotal (consulta por hash).

    Relatório HTML e JSON com cores e formatação.

    Suporte para análise de arquivos ZIP protegidos por senha (ex.: "infected").

Requisitos

    Python 3.8+

    Bibliotecas Python:

pip install requests jinja2 python-magic pefile

    (Opcional) Chave de API do VirusTotal → Criar conta gratuita

Como Usar
Análise de um arquivo local

python malware_analyzer.py --file caminho/para/arquivo.exe

Análise com VirusTotal (requere API Key)

python malware_analyzer.py --file caminho/para/arquivo.exe --vt-api SUA_CHAVE_API

Análise de arquivo ZIP protegido por senha "infected"

python malware_analyzer.py --file caminho/para/arquivo.zip --zip-pass infected

Estrutura do Projeto

.
├── malware_analyzer.py        # Script principal
├── templates/
│   └── report_template.j2     # Template HTML para relatório
├── results/                   # Pasta para relatórios gerados
└── README.md                  # Documentação do projeto

Fontes Seguras para Testes

    EICAR Test File (arquivo inofensivo para testar antivírus) → https://www.eicar.org/download-anti-malware-testfile/

    MalwareBazaar (amostras benignas ou desarmadas) → https://bazaar.abuse.ch/

    TheZoo (amostras reais zipadas com senha "infected") → https://github.com/ytisf/theZoo

    Atenção: Nunca execute amostras reais fora de ambientes controlados (VM ou sandbox).
    Este projeto é apenas para fins educativos.

Aviso Legal

Este software é destinado apenas para uso educacional e testes em ambientes controlados.
O uso contra sistemas ou arquivos de terceiros sem permissão é ilegal e pode resultar em consequências jurídicas.
O autor não se responsabiliza por usos indevidos desta ferramenta.